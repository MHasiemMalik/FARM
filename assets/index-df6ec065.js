import w from"axios";(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const n of document.querySelectorAll('link[rel="modulepreload"]'))a(n);new MutationObserver(n=>{for(const i of n)if(i.type==="childList")for(const m of i.addedNodes)m.tagName==="LINK"&&m.rel==="modulepreload"&&a(m)}).observe(document,{childList:!0,subtree:!0});function r(n){const i={};return n.integrity&&(i.integrity=n.integrity),n.referrerPolicy&&(i.referrerPolicy=n.referrerPolicy),n.crossOrigin==="use-credentials"?i.credentials="include":n.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function a(n){if(n.ep)return;n.ep=!0;const i=r(n);fetch(n.href,i)}})();function y(e,t,r){return w.get("https://api.open-meteo.com/v1/forecast?&hourly=temperature_2m,apparent_temperature,precipitation,weathercode,windspeed_10m&daily=weathercode,temperature_2m_max,temperature_2m_min,apparent_temperature_max,apparent_temperature_min,precipitation_sum&current_weather=true&timeformat=unixtime",{params:{latitude:e,longitude:t,timezone:r}}).then(({data:a})=>({current:_(a),daily:T(a),hourly:M(a)}))}function _({current_weather:e,daily:t}){const{temperature:r,windspeed:a,weathercode:n}=e,{temperature_2m_max:[i],temperature_2m_min:[m],apparent_temperature_max:[f],apparent_temperature_min:[h],precipitation_sum:[g]}=t;return{timestamp:e.time*1e3,currentTemp:Math.round(r),highTemp:Math.round(i),lowTemp:Math.round(m),highFeelsLike:Math.round(f),lowFeelsLike:Math.round(h),windSpeed:Math.round(a),precip:Math.round(g*100)/100,iconCode:n}}function T({daily:e}){return e.time.map((t,r)=>({timestamp:t*1e3,iconCode:e.weathercode[r],maxTemp:Math.round(e.temperature_2m_max[r])}))}function M({hourly:e,current_weather:t}){return e.time.map((r,a)=>({timestamp:r*1e3,iconCode:e.weathercode[a],temp:Math.round(e.temperature_2m[a]),feelsLike:Math.round(e.apparent_temperature[a]),windSpeed:Math.round(e.windspeed_10m[a]),precip:Math.round(e.precipitation[a]*100)/100})).filter(({timestamp:r})=>r>=t.time*1e3)}const d=new Map;c([0,1],"sun");c([2],"cloud-sun");c([3],"cloud");c([45,48],"smog");c([51,53,55,56,57,61,63,65,66,67,80,81,82],"cloud-showers-heavy");c([71,73,75,77,85,86],"snowflake");c([95,96,99],"cloud-bolt");function c(e,t){e.forEach(r=>{d.set(r,t)})}navigator.geolocation.getCurrentPosition(L,S);function L({coords:e}){y(e.latitude,e.longitude,Intl.DateTimeFormat().resolvedOptions().timeZone).then(F).catch(t=>{console.error(t),alert("Error getting weather.")})}function S(){alert("There was an error getting your location. Please allow us to use your location and refresh the page.")}function F({current:e,daily:t,hourly:r}){E(e),I(t),x(r),document.body.classList.remove("blurred")}function o(e,t,{parent:r=document}={}){r.querySelector(`[data-${e}]`).textContent=t}function O(e){const t=new Date(e).getHours();return t>=19||t<=4}function p(e,t){if(O(t)){if(e===0||e===1)return"icons/moon.svg";if(e===2)return"icons/cloud-moon.svg"}return`icons/${d.get(e)}.svg`}const v=document.querySelector("[data-current-icon]");function E(e){v.src=p(e.iconCode,e.timestamp),o("current-temp",e.currentTemp),o("current-high",e.highTemp),o("current-low",e.lowTemp),o("current-fl-high",e.highFeelsLike),o("current-fl-low",e.lowFeelsLike),o("current-wind",e.windSpeed),o("current-precip",e.precip)}const l=new Intl.DateTimeFormat(void 0,{weekday:"long"}),u=document.querySelector("[data-day-section]"),C=document.getElementById("day-card-template");function I(e){u.innerHTML="",e.forEach(t=>{const r=C.content.cloneNode(!0);o("temp",t.maxTemp,{parent:r}),o("date",l.format(t.timestamp),{parent:r}),r.querySelector("[data-icon]").src=p(t.iconCode),u.append(r)})}const W=new Intl.DateTimeFormat(void 0,{hour:"numeric"}),s=document.querySelector("[data-hour-section]"),q=document.getElementById("hour-row-template");function x(e){s.innerHTML="",e.forEach(t=>{const r=q.content.cloneNode(!0);o("temp",t.temp,{parent:r}),o("fl-temp",t.feelsLike,{parent:r}),o("wind",t.windSpeed,{parent:r}),o("precip",t.precip,{parent:r}),o("day",l.format(t.timestamp),{parent:r}),o("time",W.format(t.timestamp),{parent:r}),r.querySelector("[data-icon]").src=p(t.iconCode,t.timestamp),s.append(r)})}
